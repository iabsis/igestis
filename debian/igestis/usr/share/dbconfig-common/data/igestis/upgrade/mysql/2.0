set sql_mode='STRICT_TRANS_TABLES,STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER';

ALTER TABLE  `CLIENT_TYPE` ENGINE = INNODB;
ALTER TABLE  `COMPANIES` ENGINE = INNODB;
ALTER TABLE  `COUNTRIES` ENGINE = INNODB;
ALTER TABLE  `LANGUAGES` ENGINE = INNODB;
ALTER TABLE  `MARITAL_STATUS` ENGINE = INNODB;
ALTER TABLE  `USERS` ENGINE = INNODB;
ALTER TABLE  `USERS_RIGHTS` ENGINE = INNODB;
ALTER TABLE  `CONTACTS` ENGINE = INNODB;
ALTER TABLE  `USERPREFS` ENGINE = INNODB;
ALTER TABLE  `TMP_CONTACTS_IMPORT` ENGINE = INNODB;

ALTER TABLE `CLIENT_TYPE` 
ADD PRIMARY KEY (`code`) , RENAME TO  `CORE_CLIENT_TYPE` ;

ALTER TABLE `COMPANIES` RENAME TO  `CORE_COMPANIES` ;

ALTER TABLE `TMP_CONTACTS_IMPORT` RENAME TO  `CORE_TMP_CONTACTS_IMPORT` ;

ALTER TABLE `COUNTRIES` 
ADD PRIMARY KEY (`code`) , RENAME TO  `CORE_COUNTRIES` ;

ALTER TABLE `LANGUAGES` 
ADD PRIMARY KEY (`code`) , RENAME TO  `CORE_LANGUAGES` ;

ALTER TABLE `MARITAL_STATUS` 
ADD PRIMARY KEY (`code`) , RENAME TO  `CORE_CIVILITIES` ;

ALTER TABLE `USERS` CHANGE `company_id` `company_id` MEDIUMINT( 9 ) NULL DEFAULT NULL ,
CHANGE `client_type` `client_type_code` VARCHAR( 12 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL;

UPDATE `USERS` SET company_id=NULL WHERE company_id=0;
UPDATE `USERS` SET company_id=NULL WHERE company_id NOT IN(SELECT id FROM CORE_COMPANIES);
UPDATE `USERS` SET client_type_code=NULL WHERE client_type_code='';


ALTER TABLE  `USERS`
  ADD CONSTRAINT `fk_CORE_USERS_CORE_CLIENT_TYPE1`
  FOREIGN KEY (`client_type_code` )
  REFERENCES `CORE_CLIENT_TYPE` (`code` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION, 
  ADD CONSTRAINT `fk_CORE_USERS_CORE_COMPANIES1`
  FOREIGN KEY (`company_id` )
  REFERENCES `CORE_COMPANIES` (`id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION
, ADD INDEX `fk_CORE_USERS_CORE_CLIENT_TYPE1` (`client_type_code` ASC) 
, ADD INDEX `fk_CORE_USERS_CORE_COMPANIES1` (`company_id` ASC) , RENAME TO  `CORE_USERS` ;


DELETE FROM `USERS_RIGHTS` WHERE user_id NOT IN(SELECT id FROM CORE_USERS);
ALTER TABLE `USERS_RIGHTS` 
  ADD CONSTRAINT `fk_CORE_USERS_RIGHTS_CORE_USERS`
  FOREIGN KEY (`user_id` )
  REFERENCES `CORE_USERS` (`id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION
, ADD PRIMARY KEY (`user_id`, `module_name`) 
, ADD INDEX `fk_CORE_USERS_RIGHTS_CORE_USERS` (`user_id` ASC) , RENAME TO  `CORE_USERS_RIGHTS` ;



ALTER TABLE `CONTACTS` CHANGE `marital_status` `civility_code` VARCHAR( 10 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL ,
CHANGE `language` `language_code` VARCHAR( 10 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL ,
CHANGE `country` `country_code` VARCHAR( 8 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL;

UPDATE `CONTACTS` SET language_code=NULL WHERE language_code='';
UPDATE `CONTACTS` SET language_code =NULL WHERE language_code NOT IN (SELECT code FROM CORE_LANGUAGES);

UPDATE `CONTACTS` SET country_code=NULL WHERE country_code='';
UPDATE `CONTACTS` SET country_code=NULL WHERE country_code NOT IN (SELECT code FROM CORE_COUNTRIES);

UPDATE `CONTACTS` SET civility_code =NULL WHERE civility_code ='';
UPDATE `CONTACTS` SET civility_code =NULL WHERE civility_code NOT IN (SELECT code FROM CORE_CIVILITIES);

DELETE FROM CONTACTS WHERE user_id NOT IN(SELECT id FROM CORE_USERS);


ALTER TABLE `CONTACTS` 
  ADD CONSTRAINT `fk_CORE_CONTACTS_CORE_CIVILITIES1`
  FOREIGN KEY (`civility_code` )
  REFERENCES `CORE_CIVILITIES` (`code` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION, 
  ADD CONSTRAINT `fk_CORE_CONTACTS_CORE_COUNTRIES1`
  FOREIGN KEY (`country_code` )
  REFERENCES `CORE_COUNTRIES` (`code` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION, 
  ADD CONSTRAINT `fk_CORE_CONTACTS_CORE_LANGUAGES1`
  FOREIGN KEY (`language_code` )
  REFERENCES `CORE_LANGUAGES` (`code` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION, 
  ADD CONSTRAINT `fk_CORE_CONTACTS_CORE_USERS1`
  FOREIGN KEY (`user_id` )
  REFERENCES `CORE_USERS` (`id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION
, ADD INDEX `fk_CORE_CONTACTS_CORE_CIVILITIES1` (`civility_code` ASC) 
, ADD INDEX `fk_CORE_CONTACTS_CORE_COUNTRIES1` (`country_code` ASC) 
, ADD INDEX `fk_CORE_CONTACTS_CORE_LANGUAGES1` (`language_code` ASC) 
, ADD INDEX `fk_CORE_CONTACTS_CORE_USERS1` (`user_id` ASC) 
, DROP INDEX `user_id` , RENAME TO  `CORE_CONTACTS` ;

DELETE FROM `USERPREFS` WHERE contact_id NOT IN(SELECT id FROM CORE_CONTACTS);
ALTER TABLE `USERPREFS` 
  ADD CONSTRAINT `fk_CORE_USERPREFS_CORE_CONTACTS1`
  FOREIGN KEY (`contact_id` )
  REFERENCES `CORE_CONTACTS` (`id` )
  ON DELETE NO ACTION
  ON UPDATE NO ACTION
, DROP PRIMARY KEY 
, ADD PRIMARY KEY (`contact_id`, `option`) 
, ADD INDEX `fk_CORE_USERPREFS_CORE_CONTACTS1` (`contact_id` ASC) , RENAME TO  `CORE_USERPREFS` ;


create view `USERS` as SELECT * FROM CORE_USERS;
create view `CLIENT_TYPE` as SELECT * FROM `CORE_CLIENT_TYPE`;
create view `CIVILITIES` as SELECT * FROM `CORE_CIVILITIES`;
create view `COMPANIES` as SELECT * FROM `CORE_COMPANIES`;
create view `CONTACTS` as SELECT * FROM `CORE_CONTACTS`;
create view `COUNTRIES` as SELECT * FROM `CORE_COUNTRIES`;
create view `LANGUAGES` as SELECT * FROM `CORE_LANGUAGES`;
create view `USERPREFS` as SELECT * FROM `CORE_USERPREFS`;
create view `USERS_RIGHTS` as SELECT * FROM `CORE_USERS_RIGHTS`;
create view `TMP_CONTACTS_IMPORT` as SELECT * FROM `CORE_TMP_CONTACTS_IMPORT`;

ALTER TABLE `CORE_COUNTRIES` ADD `label` VARCHAR( 100 ) NOT NULL;

UPDATE CORE_COUNTRIES SET label="FRANCE" WHERE code='FR';
UPDATE CORE_COUNTRIES SET label="ARUBA" WHERE code='AW';
UPDATE CORE_COUNTRIES SET label="AFGHANISTAN" WHERE code='AF';
UPDATE CORE_COUNTRIES SET label="ANGOLA" WHERE code='AO';
UPDATE CORE_COUNTRIES SET label="ANGUILLA" WHERE code='AI';
UPDATE CORE_COUNTRIES SET label="ALBANIA" WHERE code='AL';
UPDATE CORE_COUNTRIES SET label="ANDORRA" WHERE code='AD';
UPDATE CORE_COUNTRIES SET label="ANTILLES NEERLANDAISES" WHERE code='AN';
UPDATE CORE_COUNTRIES SET label="UNITED ARAB EMIRATES" WHERE code='AE';
UPDATE CORE_COUNTRIES SET label="ARGENTINA" WHERE code='AR';
UPDATE CORE_COUNTRIES SET label="ARMENIa" WHERE code='AM';
UPDATE CORE_COUNTRIES SET label="AMERICAN SAMOA" WHERE code='AS';
UPDATE CORE_COUNTRIES SET label="POLAR REGIONS ANTARTIQUES" WHERE code='AQ';
UPDATE CORE_COUNTRIES SET label="ANTIGUA AND BARBUDA" WHERE code='AG';
UPDATE CORE_COUNTRIES SET label="AUSTRALIA" WHERE code='AU';
UPDATE CORE_COUNTRIES SET label="AUSTRIA" WHERE code='AT';
UPDATE CORE_COUNTRIES SET label="AZERBAIJAN" WHERE code='AZ';
UPDATE CORE_COUNTRIES SET label="BOSNIA AND HERZEGOVINA" WHERE code='BA';
UPDATE CORE_COUNTRIES SET label="BURUNDI" WHERE code='BI';
UPDATE CORE_COUNTRIES SET label="BELGIUM" WHERE code='BE';
UPDATE CORE_COUNTRIES SET label="BENIN" WHERE code='BJ';
UPDATE CORE_COUNTRIES SET label="BURKINA FASO" WHERE code='BF';
UPDATE CORE_COUNTRIES SET label="BANGLADESH" WHERE code='BD';
UPDATE CORE_COUNTRIES SET label="BULGARIA" WHERE code='BG';
UPDATE CORE_COUNTRIES SET label="BAHRAIN" WHERE code='BH';
UPDATE CORE_COUNTRIES SET label="BAHAMAS" WHERE code='BS';
UPDATE CORE_COUNTRIES SET label="BELARUS" WHERE code='BY';
UPDATE CORE_COUNTRIES SET label="BELIZE (Ex HONDURAS BRITANIQUE)" WHERE code='BZ';
UPDATE CORE_COUNTRIES SET label="BERMUDA" WHERE code='BM';
UPDATE CORE_COUNTRIES SET label="BOLIVA" WHERE code='BO';
UPDATE CORE_COUNTRIES SET label="BRAZIL" WHERE code='BR';
UPDATE CORE_COUNTRIES SET label="THE BARBADOS" WHERE code='BB';
UPDATE CORE_COUNTRIES SET label="BRUNEI" WHERE code='BN';
UPDATE CORE_COUNTRIES SET label="BHUTAN" WHERE code='BT';
UPDATE CORE_COUNTRIES SET label="MYANMAR (BURMA Ex)" WHERE code='BU';
UPDATE CORE_COUNTRIES SET label="BOUVET ISLAND" WHERE code='BV';
UPDATE CORE_COUNTRIES SET label="BOTSWANA" WHERE code='BW';
UPDATE CORE_COUNTRIES SET label="CENTRAL AFRICAN REPUBLIC" WHERE code='CF';
UPDATE CORE_COUNTRIES SET label="CANADA" WHERE code='CA';
UPDATE CORE_COUNTRIES SET label="ISLANDS OF COCOS (KEEPLING)" WHERE code='CC';
UPDATE CORE_COUNTRIES SET label="SWITZERLAND" WHERE code='CH';
UPDATE CORE_COUNTRIES SET label="CHILE" WHERE code='CL';
UPDATE CORE_COUNTRIES SET label="CHINA" WHERE code='CN';
UPDATE CORE_COUNTRIES SET label="COTE D'IVOIRE" WHERE code='CI';
UPDATE CORE_COUNTRIES SET label="CAMEROON" WHERE code='CM';
UPDATE CORE_COUNTRIES SET label="CONGO" WHERE code='CG';
UPDATE CORE_COUNTRIES SET label="COOK ISLANDS" WHERE code='CK';
UPDATE CORE_COUNTRIES SET label="COLOMBIA" WHERE code='CO';
UPDATE CORE_COUNTRIES SET label="COMOROS" WHERE code='KM';
UPDATE CORE_COUNTRIES SET label="REPUBLIC OF CAPE VERDE" WHERE code='CV';
UPDATE CORE_COUNTRIES SET label="COSTA RICA" WHERE code='CR';
UPDATE CORE_COUNTRIES SET label="CZECHOSLOVAKIA" WHERE code='CS';
UPDATE CORE_COUNTRIES SET label="ISLAND TOWNSHIP ENDERBURY" WHERE code='CT';
UPDATE CORE_COUNTRIES SET label="CUBA" WHERE code='CU';
UPDATE CORE_COUNTRIES SET label="CHRISTMAS ISLAND" WHERE code='C';
UPDATE CORE_COUNTRIES SET label="CAYMAN ISLANDS" WHERE code='KY';
UPDATE CORE_COUNTRIES SET label="CYPRUS" WHERE code='CY';
UPDATE CORE_COUNTRIES SET label="CZECH REPUBLIC" WHERE code='CZ';
UPDATE CORE_COUNTRIES SET label="FEDERAL REPUBLIC OF GERMANY" WHERE code='DE';
UPDATE CORE_COUNTRIES SET label="DJIBOUTI" WHERE code='DJ';
UPDATE CORE_COUNTRIES SET label="DOMINICA" WHERE code='DM';
UPDATE CORE_COUNTRIES SET label="DENMARK" WHERE code='DK';
UPDATE CORE_COUNTRIES SET label="DOMINICAN REPUBLIC" WHERE code='DO';
UPDATE CORE_COUNTRIES SET label="ALGERIA" WHERE code='DZ';
UPDATE CORE_COUNTRIES SET label="ECUADOR" WHERE code='EC';
UPDATE CORE_COUNTRIES SET label="EGYPT" WHERE code='EG';
UPDATE CORE_COUNTRIES SET label="SPAIN" WHERE code='ES';
UPDATE CORE_COUNTRIES SET label="ESTONIA" WHERE code='EE';
UPDATE CORE_COUNTRIES SET label="ETHIOPIA" WHERE code='ET';
UPDATE CORE_COUNTRIES SET label="FINLAND" WHERE code='FI';
UPDATE CORE_COUNTRIES SET label="FIJI" WHERE code='FJ';
UPDATE CORE_COUNTRIES SET label="FALKLAND ISLANDS" WHERE code='FK';
UPDATE CORE_COUNTRIES SET label="FAROE ISLANDS" WHERE code='FO';
UPDATE CORE_COUNTRIES SET label="GABON" WHERE code='GA';
UPDATE CORE_COUNTRIES SET label="UNITED KINGDOM" WHERE code='GB';
UPDATE CORE_COUNTRIES SET label="GEORGIA" WHERE code='GE';
UPDATE CORE_COUNTRIES SET label="ISLE OF GUERNSEY" WHERE code='GG';
UPDATE CORE_COUNTRIES SET label="GHANA" WHERE code='GH';
UPDATE CORE_COUNTRIES SET label="GIBRALTAR" WHERE code='GI';
UPDATE CORE_COUNTRIES SET label="GUINEA" WHERE code='GN';
UPDATE CORE_COUNTRIES SET label="GUADELOUPE" WHERE code='GP';
UPDATE CORE_COUNTRIES SET label="GAMBIA" WHERE code='GM';
UPDATE CORE_COUNTRIES SET label="GUINEA BISSAU" WHERE code='GW';
UPDATE CORE_COUNTRIES SET label="EQUATORIAL GUINEA REPUBLIC" WHERE code='GQ';
UPDATE CORE_COUNTRIES SET label="GREECE" WHERE code='GR';
UPDATE CORE_COUNTRIES SET label="GRENADE" WHERE code='GD';
UPDATE CORE_COUNTRIES SET label="GREENLAND" WHERE code='GL';
UPDATE CORE_COUNTRIES SET label="GUATEMALA" WHERE code='GT';
UPDATE CORE_COUNTRIES SET label="GUYANA" WHERE code='GF';
UPDATE CORE_COUNTRIES SET label="GUAM" WHERE code='GU';
UPDATE CORE_COUNTRIES SET label="GUYANA" WHERE code='GY';
UPDATE CORE_COUNTRIES SET label="HONG-KONG" WHERE code='HK';
UPDATE CORE_COUNTRIES SET label="ISLANDS AND HEARD MAC DONALD" WHERE code='HM';
UPDATE CORE_COUNTRIES SET label="HONDURAS" WHERE code='HN';
UPDATE CORE_COUNTRIES SET label="CROATIA" WHERE code='HR';
UPDATE CORE_COUNTRIES SET label="HAITI" WHERE code='HT';
UPDATE CORE_COUNTRIES SET label="HUNGARY" WHERE code='HU';
UPDATE CORE_COUNTRIES SET label="INDONESIA" WHERE code='ID';
UPDATE CORE_COUNTRIES SET label="ISLE OF MAN" WHERE code='IM';
UPDATE CORE_COUNTRIES SET label="INDIA" WHERE code='IN';
UPDATE CORE_COUNTRIES SET label="INDIAN OCEAN (BRITISH LAND)" WHERE code='IO';
UPDATE CORE_COUNTRIES SET label="EIRE" WHERE code='IE';
UPDATE CORE_COUNTRIES SET label="IRAN" WHERE code='IR';
UPDATE CORE_COUNTRIES SET label="IRAQ" WHERE code='IQ';
UPDATE CORE_COUNTRIES SET label="ISLAND" WHERE code='IS';
UPDATE CORE_COUNTRIES SET label="ISRAEL" WHERE code='IL';
UPDATE CORE_COUNTRIES SET label="ITALY" WHERE code='IT';
UPDATE CORE_COUNTRIES SET label="JAMAICA" WHERE code='JM';
UPDATE CORE_COUNTRIES SET label="ISLAND OF JERSEY" WHERE code='JE';
UPDATE CORE_COUNTRIES SET label="JORDAN" WHERE code='JO';
UPDATE CORE_COUNTRIES SET label="JAPAN" WHERE code='JP';
UPDATE CORE_COUNTRIES SET label="JOHNSTON" WHERE code='JT';
UPDATE CORE_COUNTRIES SET label="KAZAKHSTAN" WHERE code='KZ';
UPDATE CORE_COUNTRIES SET label="KENYA" WHERE code='KE';
UPDATE CORE_COUNTRIES SET label="KYRGYZSTAN" WHERE code='KG';
UPDATE CORE_COUNTRIES SET label="KAMPUCHEA (Ex CAMBODIA)" WHERE code='KH';
UPDATE CORE_COUNTRIES SET label="KIRIBATI" WHERE code='KI';
UPDATE CORE_COUNTRIES SET label="SAINT CHRISTOPHER NIEVES ENGLISH" WHERE code='KN';
UPDATE CORE_COUNTRIES SET label="REPUBLIC OK KOREA" WHERE code='KR';
UPDATE CORE_COUNTRIES SET label="KOWAIT" WHERE code='KW';
UPDATE CORE_COUNTRIES SET label="LAOS" WHERE code='LA';
UPDATE CORE_COUNTRIES SET label="LEBANON" WHERE code='LB';
UPDATE CORE_COUNTRIES SET label="LIBERIA" WHERE code='LR';
UPDATE CORE_COUNTRIES SET label="LIBYAN ARAB JAMAHIRIYA" WHERE code='LY';
UPDATE CORE_COUNTRIES SET label="SAINT LUCIA" WHERE code='LC';
UPDATE CORE_COUNTRIES SET label="LIECHTENSTEIN" WHERE code='LI';
UPDATE CORE_COUNTRIES SET label="SRI LANKA" WHERE code='LK';
UPDATE CORE_COUNTRIES SET label="LESOTHO" WHERE code='LS';
UPDATE CORE_COUNTRIES SET label="LITHUANIA" WHERE code='LT';
UPDATE CORE_COUNTRIES SET label="LUXEMBOURG" WHERE code='LU';
UPDATE CORE_COUNTRIES SET label="LATVIA" WHERE code='LV';
UPDATE CORE_COUNTRIES SET label="MACAO" WHERE code='MO';
UPDATE CORE_COUNTRIES SET label="MOROCCO" WHERE code='MA';
UPDATE CORE_COUNTRIES SET label="MONACO" WHERE code='MC';
UPDATE CORE_COUNTRIES SET label="MOLDAVA (REPUBLIC OF)" WHERE code='MD';
UPDATE CORE_COUNTRIES SET label="MADAGASCAR" WHERE code='MG';
UPDATE CORE_COUNTRIES SET label="MALDIVES" WHERE code='MV';
UPDATE CORE_COUNTRIES SET label="MEXICO" WHERE code='MX';
UPDATE CORE_COUNTRIES SET label="MIDWAY" WHERE code='MI';
UPDATE CORE_COUNTRIES SET label="MACEDONIA" WHERE code='MK';
UPDATE CORE_COUNTRIES SET label="MALI" WHERE code='ML';
UPDATE CORE_COUNTRIES SET label="MALTA" WHERE code='MT';
UPDATE CORE_COUNTRIES SET label="MONGOLIA" WHERE code='MN';
UPDATE CORE_COUNTRIES SET label="MOZAMBIQUE" WHERE code='MZ';
UPDATE CORE_COUNTRIES SET label="MAURITANIA" WHERE code='MR';
UPDATE CORE_COUNTRIES SET label="MONTSERRAT" WHERE code='MS';
UPDATE CORE_COUNTRIES SET label="MARTINIQUE" WHERE code='MQ';
UPDATE CORE_COUNTRIES SET label="ILE MAURICE" WHERE code='MU';
UPDATE CORE_COUNTRIES SET label="MALAWI" WHERE code='MW';
UPDATE CORE_COUNTRIES SET label="MYANMAR" WHERE code='MM';
UPDATE CORE_COUNTRIES SET label="MALAYSIA" WHERE code='MY';
UPDATE CORE_COUNTRIES SET label="NAMIBIA" WHERE code='NA';
UPDATE CORE_COUNTRIES SET label="NEW CALEDONIA" WHERE code='NC';
UPDATE CORE_COUNTRIES SET label="NIGER" WHERE code='NE';
UPDATE CORE_COUNTRIES SET label="NORFOLK ISLAND" WHERE code='NF';
UPDATE CORE_COUNTRIES SET label="NIGERIA" WHERE code='NG';
UPDATE CORE_COUNTRIES SET label="NICARAGUA" WHERE code='NI';
UPDATE CORE_COUNTRIES SET label="NIUE" WHERE code='NU';
UPDATE CORE_COUNTRIES SET label="NETHERLANDS" WHERE code='NL';
UPDATE CORE_COUNTRIES SET label="NORWAY" WHERE code='NO';
UPDATE CORE_COUNTRIES SET label="NEPAL" WHERE code='NP';
UPDATE CORE_COUNTRIES SET label="NAURU" WHERE code='NR';
UPDATE CORE_COUNTRIES SET label="NEW ZEALAND" WHERE code='NZ';
UPDATE CORE_COUNTRIES SET label="OMAN" WHERE code='OM';
UPDATE CORE_COUNTRIES SET label="PAKISTAN" WHERE code='PK';
UPDATE CORE_COUNTRIES SET label="PANAMA" WHERE code='PA';
UPDATE CORE_COUNTRIES SET label="PACIFIC ISLANDS" WHERE code='PC';
UPDATE CORE_COUNTRIES SET label="PITCAIRN ISLANDS" WHERE code='PN';
UPDATE CORE_COUNTRIES SET label="PERU" WHERE code='PE';
UPDATE CORE_COUNTRIES SET label="PHILIPPINES" WHERE code='PH';
UPDATE CORE_COUNTRIES SET label="PAPUA NEW GUINEA" WHERE code='PG';
UPDATE CORE_COUNTRIES SET label="POLAND" WHERE code='PL';
UPDATE CORE_COUNTRIES SET label="PUERTO RICO" WHERE code='PR';
UPDATE CORE_COUNTRIES SET label="NORTH KOREA" WHERE code='KP';
UPDATE CORE_COUNTRIES SET label="PORTUGAL" WHERE code='PT';
UPDATE CORE_COUNTRIES SET label="PARAGUAY" WHERE code='PY';
UPDATE CORE_COUNTRIES SET label="OCEANIA AMERICAN" WHERE code='PU';
UPDATE CORE_COUNTRIES SET label="FRENCH POLYNESIA" WHERE code='PF';
UPDATE CORE_COUNTRIES SET label="QATAR" WHERE code='QA';
UPDATE CORE_COUNTRIES SET label="REUNION" WHERE code='RE';
UPDATE CORE_COUNTRIES SET label="ROMANIA" WHERE code='RO';
UPDATE CORE_COUNTRIES SET label="RUSSIA (FEDERATION OF)" WHERE code='RU';
UPDATE CORE_COUNTRIES SET label="RWANDA" WHERE code='RW';
UPDATE CORE_COUNTRIES SET label="SAUDI ARABIA" WHERE code='SA';
UPDATE CORE_COUNTRIES SET label="SUDAN" WHERE code='SD';
UPDATE CORE_COUNTRIES SET label="USSR" WHERE code='SU';
UPDATE CORE_COUNTRIES SET label="SENEGAL" WHERE code='SN';
UPDATE CORE_COUNTRIES SET label="SINGAPORE" WHERE code='SG';
UPDATE CORE_COUNTRIES SET label="SAINTE HELENE" WHERE code='SH';
UPDATE CORE_COUNTRIES SET label="ILE SVALBARD AND JAN MAYEN" WHERE code='SJ';
UPDATE CORE_COUNTRIES SET label="SOLOMON ISLANDS" WHERE code='SB';
UPDATE CORE_COUNTRIES SET label="SIERRA LEONE" WHERE code='SL';
UPDATE CORE_COUNTRIES SET label="EL SALVADOR" WHERE code='SV';
UPDATE CORE_COUNTRIES SET label="SAN MARINO" WHERE code='SM';
UPDATE CORE_COUNTRIES SET label="SOMALIA" WHERE code='SO';
UPDATE CORE_COUNTRIES SET label="SAINT-PIERRE AND MIQUELON" WHERE code='PM';
UPDATE CORE_COUNTRIES SET label="SAO TOME AND PRINCIPE" WHERE code='ST';
UPDATE CORE_COUNTRIES SET label="SURINAME" WHERE code='SR';
UPDATE CORE_COUNTRIES SET label="SLOVAK REPUBLIK" WHERE code='SK';
UPDATE CORE_COUNTRIES SET label="SLOVENIA" WHERE code='SI';
UPDATE CORE_COUNTRIES SET label="SWEDEN" WHERE code='SE';
UPDATE CORE_COUNTRIES SET label="SWAZILAND" WHERE code='SZ';
UPDATE CORE_COUNTRIES SET label="SEYCHELLES AND DEPENDENCIES" WHERE code='SC';
UPDATE CORE_COUNTRIES SET label="SYRIA" WHERE code='SY';
UPDATE CORE_COUNTRIES SET label="TURKS AND CAICOS ISLANDS" WHERE code='TC';
UPDATE CORE_COUNTRIES SET label="CHAD" WHERE code='TD';
UPDATE CORE_COUNTRIES SET label="TOGO" WHERE code='TG';
UPDATE CORE_COUNTRIES SET label="THAILAND" WHERE code='TH';
UPDATE CORE_COUNTRIES SET label="TAJIKISTAN" WHERE code='TJ';
UPDATE CORE_COUNTRIES SET label="TOKELAU" WHERE code='TK';
UPDATE CORE_COUNTRIES SET label="TURKMENISTAN" WHERE code='TM';
UPDATE CORE_COUNTRIES SET label="EAST TIMOR" WHERE code='TP';
UPDATE CORE_COUNTRIES SET label="TONGA" WHERE code='TO';
UPDATE CORE_COUNTRIES SET label="TRINIDAD AND TOBAGO" WHERE code='TT';
UPDATE CORE_COUNTRIES SET label="TUNISIA" WHERE code='TN';
UPDATE CORE_COUNTRIES SET label="TURKEY" WHERE code='TR';
UPDATE CORE_COUNTRIES SET label="TUVALU" WHERE code='TV';
UPDATE CORE_COUNTRIES SET label="TAIWAN" WHERE code='TW';
UPDATE CORE_COUNTRIES SET label="TANZANIA" WHERE code='TZ';
UPDATE CORE_COUNTRIES SET label="UGANDA" WHERE code='UG';
UPDATE CORE_COUNTRIES SET label="UKRAINE" WHERE code='UA';
UPDATE CORE_COUNTRIES SET label="URUGUAY" WHERE code='UY';
UPDATE CORE_COUNTRIES SET label="UNITED STATES OF AMERICA" WHERE code='US';
UPDATE CORE_COUNTRIES SET label="OUZBEKISTAN" WHERE code='UZ';
UPDATE CORE_COUNTRIES SET label="VATICAN" WHERE code='VA';
UPDATE CORE_COUNTRIES SET label="SAINT-VINCENT AND GRENADINES" WHERE code='VC';
UPDATE CORE_COUNTRIES SET label="VENEZUELA" WHERE code='VE';
UPDATE CORE_COUNTRIES SET label="BRITISH VIRGIN ISLANDS" WHERE code='VG';
UPDATE CORE_COUNTRIES SET label="VIRGIN ISLANDS" WHERE code='VI';
UPDATE CORE_COUNTRIES SET label="VIETNAM" WHERE code='VN';
UPDATE CORE_COUNTRIES SET label="VANUATU (ANC NLLES HEBRID)" WHERE code='VU';
UPDATE CORE_COUNTRIES SET label="WAKE" WHERE code='WK';
UPDATE CORE_COUNTRIES SET label="WALLIS AND FUTUNA ISLANDS" WHERE code='WF';
UPDATE CORE_COUNTRIES SET label="WESTERN SAMOA" WHERE code='WS';
UPDATE CORE_COUNTRIES SET label="ABU DHABI" WHERE code='XA';
UPDATE CORE_COUNTRIES SET label="CEUTA AND MELILLA" WHERE code='XC';
UPDATE CORE_COUNTRIES SET label="DUBAI" WHERE code='XD';
UPDATE CORE_COUNTRIES SET label="THE CANARIAN ISLANDS" WHERE code='XI';
UPDATE CORE_COUNTRIES SET label="MAYOTTE" WHERE code='XM';
UPDATE CORE_COUNTRIES SET label="OCEANIA NEO ZELANDAISE" WHERE code='XR';
UPDATE CORE_COUNTRIES SET label="SHARJAH" WHERE code='XS';
UPDATE CORE_COUNTRIES SET label="YEMEN" WHERE code='YE';
UPDATE CORE_COUNTRIES SET label="YUGOSLAVIA" WHERE code='YU';
UPDATE CORE_COUNTRIES SET label="SOUTH AFRICA" WHERE code='ZA';
UPDATE CORE_COUNTRIES SET label="ZAIRE" WHERE code='ZR';
UPDATE CORE_COUNTRIES SET label="ZAMBIA" WHERE code='ZM';
UPDATE CORE_COUNTRIES SET label="ZIMBABWE (Ex RHODESIE)" WHERE code='ZW';

ALTER TABLE  `CORE_LANGUAGES` ADD  `label` VARCHAR( 120 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL;

UPDATE CORE_LANGUAGES SET label='Afar' WHERE code='AA';
UPDATE CORE_LANGUAGES SET label='Abkhazian' WHERE code='AB';
UPDATE CORE_LANGUAGES SET label='Avestan' WHERE code='AE';
UPDATE CORE_LANGUAGES SET label='Afrikaans' WHERE code='AF';
UPDATE CORE_LANGUAGES SET label='Akan' WHERE code='AK';
UPDATE CORE_LANGUAGES SET label='Amharic' WHERE code='AM';
UPDATE CORE_LANGUAGES SET label='Aragonese' WHERE code='AN';
UPDATE CORE_LANGUAGES SET label='Arabic' WHERE code='AR';
UPDATE CORE_LANGUAGES SET label='Assamese' WHERE code='AS';
UPDATE CORE_LANGUAGES SET label='Avaric' WHERE code='AV';
UPDATE CORE_LANGUAGES SET label='Aymara' WHERE code='AY';
UPDATE CORE_LANGUAGES SET label='Azeri' WHERE code='AZ';
UPDATE CORE_LANGUAGES SET label='Bashkir' WHERE code='BA';
UPDATE CORE_LANGUAGES SET label='Belarusian' WHERE code='BE';
UPDATE CORE_LANGUAGES SET label='Bulgarian' WHERE code='BG';
UPDATE CORE_LANGUAGES SET label='Bihari' WHERE code='BH';
UPDATE CORE_LANGUAGES SET label='Bislama' WHERE code='BI';
UPDATE CORE_LANGUAGES SET label='Bambara' WHERE code='BM';
UPDATE CORE_LANGUAGES SET label='Bengali' WHERE code='BN';
UPDATE CORE_LANGUAGES SET label='Tibetan' WHERE code='BO';
UPDATE CORE_LANGUAGES SET label='Breton' WHERE code='BR';
UPDATE CORE_LANGUAGES SET label='Bosnian' WHERE code='BS';
UPDATE CORE_LANGUAGES SET label='Catalan' WHERE code='CA';
UPDATE CORE_LANGUAGES SET label='Chechen' WHERE code='CE';
UPDATE CORE_LANGUAGES SET label='Chamorro' WHERE code='CH';
UPDATE CORE_LANGUAGES SET label='Corsica' WHERE code='CO';
UPDATE CORE_LANGUAGES SET label='Trendy' WHERE code='CR';
UPDATE CORE_LANGUAGES SET label='Czech' WHERE code='CS';
UPDATE CORE_LANGUAGES SET label='Old slave' WHERE code='CU';
UPDATE CORE_LANGUAGES SET label='Chuvash' WHERE code='CV';
UPDATE CORE_LANGUAGES SET label='Welsh' WHERE code='CY';
UPDATE CORE_LANGUAGES SET label='Danish' WHERE code='DA';
UPDATE CORE_LANGUAGES SET label='German' WHERE code='DE';
UPDATE CORE_LANGUAGES SET label='Dhivehi' WHERE code='DV';
UPDATE CORE_LANGUAGES SET label='Dzongkha' WHERE code='DZ';
UPDATE CORE_LANGUAGES SET label='Ewe' WHERE code='EE';
UPDATE CORE_LANGUAGES SET label='Modern greek' WHERE code='EL';
UPDATE CORE_LANGUAGES SET label='English' WHERE code='EN';
UPDATE CORE_LANGUAGES SET label='Esperanto' WHERE code='EO';
UPDATE CORE_LANGUAGES SET label='Spanish' WHERE code='ES';
UPDATE CORE_LANGUAGES SET label='Estonian' WHERE code='ET';
UPDATE CORE_LANGUAGES SET label='Basque' WHERE code='EU';
UPDATE CORE_LANGUAGES SET label='Persia' WHERE code='FA';
UPDATE CORE_LANGUAGES SET label='Fulah' WHERE code='FF';
UPDATE CORE_LANGUAGES SET label='Finnish' WHERE code='FI';
UPDATE CORE_LANGUAGES SET label='Fijian' WHERE code='FJ';
UPDATE CORE_LANGUAGES SET label='Faeroese' WHERE code='FO';
UPDATE CORE_LANGUAGES SET label='French' WHERE code='FR';
UPDATE CORE_LANGUAGES SET label='Frisian' WHERE code='FY';
UPDATE CORE_LANGUAGES SET label='Irish' WHERE code='GA';
UPDATE CORE_LANGUAGES SET label='Scots' WHERE code='GD';
UPDATE CORE_LANGUAGES SET label='Galician' WHERE code='GL';
UPDATE CORE_LANGUAGES SET label='Guarani' WHERE code='GN';
UPDATE CORE_LANGUAGES SET label='Gujarati' WHERE code='GU';
UPDATE CORE_LANGUAGES SET label='Manx' WHERE code='GV';
UPDATE CORE_LANGUAGES SET label='Hausa' WHERE code='HA';
UPDATE CORE_LANGUAGES SET label='Hebrew' WHERE code='HE';
UPDATE CORE_LANGUAGES SET label='Hindi' WHERE code='HI';
UPDATE CORE_LANGUAGES SET label='Hiri motu' WHERE code='HO';
UPDATE CORE_LANGUAGES SET label='Croatian' WHERE code='HR';
UPDATE CORE_LANGUAGES SET label='Haitian Creole' WHERE code='HT';
UPDATE CORE_LANGUAGES SET label='Hungarian' WHERE code='HU';
UPDATE CORE_LANGUAGES SET label='Arménian' WHERE code='HY';
UPDATE CORE_LANGUAGES SET label='Herero' WHERE code='HZ';
UPDATE CORE_LANGUAGES SET label='Interlingua' WHERE code='IA';
UPDATE CORE_LANGUAGES SET label='Indonésian' WHERE code='ID';
UPDATE CORE_LANGUAGES SET label='Western' WHERE code='IE';
UPDATE CORE_LANGUAGES SET label='Igbo' WHERE code='IG';
UPDATE CORE_LANGUAGES SET label='Nosu' WHERE code='II';
UPDATE CORE_LANGUAGES SET label='Inupiaq' WHERE code='IK';
UPDATE CORE_LANGUAGES SET label='Ido' WHERE code='IO';
UPDATE CORE_LANGUAGES SET label='Icelandic' WHERE code='IS';
UPDATE CORE_LANGUAGES SET label='Italian' WHERE code='IT';
UPDATE CORE_LANGUAGES SET label='Inuktitut' WHERE code='IU';
UPDATE CORE_LANGUAGES SET label='Japanese' WHERE code='JA';
UPDATE CORE_LANGUAGES SET label='Javanese' WHERE code='JV';
UPDATE CORE_LANGUAGES SET label='Géorgian' WHERE code='KA';
UPDATE CORE_LANGUAGES SET label='Kikongo' WHERE code='KG';
UPDATE CORE_LANGUAGES SET label='Kikuyu' WHERE code='KI';
UPDATE CORE_LANGUAGES SET label='Kuanyama' WHERE code='KJ';
UPDATE CORE_LANGUAGES SET label='Kazakh' WHERE code='KK';
UPDATE CORE_LANGUAGES SET label='Kalaallisut' WHERE code='KL';
UPDATE CORE_LANGUAGES SET label='Khmer' WHERE code='KM';
UPDATE CORE_LANGUAGES SET label='Kannada' WHERE code='KN';
UPDATE CORE_LANGUAGES SET label='Korean' WHERE code='KO';
UPDATE CORE_LANGUAGES SET label='Kanuri' WHERE code='KR';
UPDATE CORE_LANGUAGES SET label='Kashmiri' WHERE code='KS';
UPDATE CORE_LANGUAGES SET label='Kurdish' WHERE code='KU';
UPDATE CORE_LANGUAGES SET label='Komi' WHERE code='KV';
UPDATE CORE_LANGUAGES SET label='Cornish' WHERE code='KW';
UPDATE CORE_LANGUAGES SET label='Kirghiz' WHERE code='KY';
UPDATE CORE_LANGUAGES SET label='Latin' WHERE code='LA';
UPDATE CORE_LANGUAGES SET label='Luxembourg' WHERE code='LB';
UPDATE CORE_LANGUAGES SET label='Ganda' WHERE code='LG';
UPDATE CORE_LANGUAGES SET label='Limburgish' WHERE code='LI';
UPDATE CORE_LANGUAGES SET label='Lingala' WHERE code='LN';
UPDATE CORE_LANGUAGES SET label='Lao' WHERE code='LO';
UPDATE CORE_LANGUAGES SET label='Lithuanian' WHERE code='LT';
UPDATE CORE_LANGUAGES SET label='Tchiluba' WHERE code='LU';
UPDATE CORE_LANGUAGES SET label='Latvian' WHERE code='LV';
UPDATE CORE_LANGUAGES SET label='Malgasy' WHERE code='MG';
UPDATE CORE_LANGUAGES SET label='Marshallese' WHERE code='MH';
UPDATE CORE_LANGUAGES SET label='Maori of New-Zealand' WHERE code='MI';
UPDATE CORE_LANGUAGES SET label='Macedonian' WHERE code='MK';
UPDATE CORE_LANGUAGES SET label='Malayalam' WHERE code='ML';
UPDATE CORE_LANGUAGES SET label='Mongolian' WHERE code='MN';
UPDATE CORE_LANGUAGES SET label='Moldavian' WHERE code='MO';
UPDATE CORE_LANGUAGES SET label='Marathi' WHERE code='MR';
UPDATE CORE_LANGUAGES SET label='Malay' WHERE code='MS';
UPDATE CORE_LANGUAGES SET label='Maltese' WHERE code='MT';
UPDATE CORE_LANGUAGES SET label='Birmese' WHERE code='MY';
UPDATE CORE_LANGUAGES SET label='Nauru' WHERE code='NA';
UPDATE CORE_LANGUAGES SET label='Norwegian Bokmål' WHERE code='NB';
UPDATE CORE_LANGUAGES SET label='Ndebele North' WHERE code='ND';
UPDATE CORE_LANGUAGES SET label='Nepali' WHERE code='NE';
UPDATE CORE_LANGUAGES SET label='Ndonga' WHERE code='NG';
UPDATE CORE_LANGUAGES SET label='Dutch' WHERE code='NL';
UPDATE CORE_LANGUAGES SET label='Norwegian Nynorsk' WHERE code='NN';
UPDATE CORE_LANGUAGES SET label='Norwegian' WHERE code='NO';
UPDATE CORE_LANGUAGES SET label='Ndebele Soulth' WHERE code='NR';
UPDATE CORE_LANGUAGES SET label='Navajo' WHERE code='NV';
UPDATE CORE_LANGUAGES SET label='Chichewa' WHERE code='NY';
UPDATE CORE_LANGUAGES SET label='Occitan' WHERE code='OC';
UPDATE CORE_LANGUAGES SET label='Ojibway' WHERE code='OJ';
UPDATE CORE_LANGUAGES SET label='Oromo' WHERE code='OM';
UPDATE CORE_LANGUAGES SET label='Oriya' WHERE code='OR';
UPDATE CORE_LANGUAGES SET label='Ossetic' WHERE code='OS';
UPDATE CORE_LANGUAGES SET label='Punjabi' WHERE code='PA';
UPDATE CORE_LANGUAGES SET label='Pali' WHERE code='PI';
UPDATE CORE_LANGUAGES SET label='Polish' WHERE code='PL';
UPDATE CORE_LANGUAGES SET label='Pushto' WHERE code='PS';
UPDATE CORE_LANGUAGES SET label='Portuguese' WHERE code='PT';
UPDATE CORE_LANGUAGES SET label='Quechua' WHERE code='QU';
UPDATE CORE_LANGUAGES SET label='Romansch' WHERE code='RM';
UPDATE CORE_LANGUAGES SET label='Kirundi' WHERE code='RN';
UPDATE CORE_LANGUAGES SET label='Romanian' WHERE code='RO';
UPDATE CORE_LANGUAGES SET label='Russian' WHERE code='RU';
UPDATE CORE_LANGUAGES SET label='Kinyarwanda' WHERE code='RW';
UPDATE CORE_LANGUAGES SET label='Ruthenian' WHERE code='RY';
UPDATE CORE_LANGUAGES SET label='Sanskrit' WHERE code='SA';
UPDATE CORE_LANGUAGES SET label='Sardinian' WHERE code='SC';
UPDATE CORE_LANGUAGES SET label='Sindhi' WHERE code='SD';
UPDATE CORE_LANGUAGES SET label='Same North' WHERE code='SE';
UPDATE CORE_LANGUAGES SET label='Sango' WHERE code='SG';
UPDATE CORE_LANGUAGES SET label='Serbo-croatian' WHERE code='SH';
UPDATE CORE_LANGUAGES SET label='Sinhalese' WHERE code='SI';
UPDATE CORE_LANGUAGES SET label='Slovak' WHERE code='SK';
UPDATE CORE_LANGUAGES SET label='Slovenian' WHERE code='SL';
UPDATE CORE_LANGUAGES SET label='Samoan' WHERE code='SM';
UPDATE CORE_LANGUAGES SET label='Shona' WHERE code='SN';
UPDATE CORE_LANGUAGES SET label='Somali' WHERE code='SO';
UPDATE CORE_LANGUAGES SET label='Albanian' WHERE code='SQ';
UPDATE CORE_LANGUAGES SET label='Serbian' WHERE code='SR';
UPDATE CORE_LANGUAGES SET label='Siswati' WHERE code='SS';
UPDATE CORE_LANGUAGES SET label='South Sotho' WHERE code='ST';
UPDATE CORE_LANGUAGES SET label='Sundanais' WHERE code='SU';
UPDATE CORE_LANGUAGES SET label='Swedish' WHERE code='SV';
UPDATE CORE_LANGUAGES SET label='Swahili' WHERE code='SW';
UPDATE CORE_LANGUAGES SET label='Tamil' WHERE code='TA';
UPDATE CORE_LANGUAGES SET label='Télugu' WHERE code='TE';
UPDATE CORE_LANGUAGES SET label='Tajik' WHERE code='TG';
UPDATE CORE_LANGUAGES SET label='Thai' WHERE code='TH';
UPDATE CORE_LANGUAGES SET label='Tigrinya' WHERE code='TI';
UPDATE CORE_LANGUAGES SET label='Turkmen' WHERE code='TK';
UPDATE CORE_LANGUAGES SET label='Tagalog' WHERE code='TL';
UPDATE CORE_LANGUAGES SET label='Tswana' WHERE code='TN';
UPDATE CORE_LANGUAGES SET label='Tongien' WHERE code='TO';
UPDATE CORE_LANGUAGES SET label='Turkish' WHERE code='TR';
UPDATE CORE_LANGUAGES SET label='Tsonga' WHERE code='TS';
UPDATE CORE_LANGUAGES SET label='Tatar' WHERE code='TT';
UPDATE CORE_LANGUAGES SET label='Twi' WHERE code='TW';
UPDATE CORE_LANGUAGES SET label='Tahitian' WHERE code='TY';
UPDATE CORE_LANGUAGES SET label='Uighur' WHERE code='UG';
UPDATE CORE_LANGUAGES SET label='Ukrainian' WHERE code='UK';
UPDATE CORE_LANGUAGES SET label='Urdu' WHERE code='UR';
UPDATE CORE_LANGUAGES SET label='Uzbek' WHERE code='UZ';
UPDATE CORE_LANGUAGES SET label='Venda' WHERE code='VE';
UPDATE CORE_LANGUAGES SET label='Vietnamese' WHERE code='VI';
UPDATE CORE_LANGUAGES SET label='Volapuk' WHERE code='VO';
UPDATE CORE_LANGUAGES SET label='Walloon' WHERE code='WA';
UPDATE CORE_LANGUAGES SET label='Wolof' WHERE code='WO';
UPDATE CORE_LANGUAGES SET label='Xhosa' WHERE code='XH';
UPDATE CORE_LANGUAGES SET label='Yiddish' WHERE code='YI';
UPDATE CORE_LANGUAGES SET label='Yoruba' WHERE code='YO';
UPDATE CORE_LANGUAGES SET label='Zhuang' WHERE code='ZA';
UPDATE CORE_LANGUAGES SET label='Chinese' WHERE code='ZH';
UPDATE CORE_LANGUAGES SET label='Zulu' WHERE code='ZU';


ALTER TABLE `CORE_CIVILITIES` ADD `label` VARCHAR( 20 ) NOT NULL;
UPDATE `CORE_CIVILITIES` SET `label` = 'Doctor' WHERE `CORE_CIVILITIES`.`code` = 'DOCTOR';
UPDATE `CORE_CIVILITIES` SET `label` = 'Miss' WHERE `CORE_CIVILITIES`.`code` = 'MISS';
UPDATE `CORE_CIVILITIES` SET `label` = 'Mister' WHERE `CORE_CIVILITIES`.`code` = 'MR';
UPDATE `CORE_CIVILITIES` SET `label` = 'Madam' WHERE `CORE_CIVILITIES`.`code` = 'MRS';


--
-- Structure de la table `CORE_HOMEPAGE_CONTENT`
--

CREATE TABLE IF NOT EXISTS `CORE_HOMEPAGE_CONTENT` (
  `id` mediumint(9) NOT NULL AUTO_INCREMENT,
  `date_add` datetime NOT NULL,
  `content` longtext COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1 ;


ALTER TABLE `CORE_CONTACTS` CHANGE `id` `id` MEDIUMINT(9) NOT NULL AUTO_INCREMENT, CHANGE `user_id` `user_id` MEDIUMINT(9) NOT NULL, CHANGE `login` `login` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL, CHANGE `password` `password` VARCHAR(120) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `ssh_password` `ssh_password` BLOB NULL DEFAULT NULL, CHANGE `civility_code` `civility_code` VARCHAR(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `firstname` `firstname` VARCHAR(150) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL, CHANGE `lastname` `lastname` VARCHAR(150) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL, CHANGE `email` `email` VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `nb_login_try` `nb_login_try` TINYINT(4) NULL DEFAULT NULL, CHANGE `last_login_try` `last_login_try` DATETIME NULL DEFAULT NULL, CHANGE `change_password_request_id` `change_password_request_id` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `change_password_request_date` `change_password_request_date` DATE NULL DEFAULT NULL, CHANGE `language_code` `language_code` VARCHAR(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `address1` `address1` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `address2` `address2` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `postal_code` `postal_code` VARCHAR(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `city` `city` VARCHAR(60) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `country_code` `country_code` VARCHAR(8) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `phone1` `phone1` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `phone2` `phone2` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `mobile` `mobile` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `fax` `fax` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `main_contact` `main_contact` TINYINT(4) NOT NULL, CHANGE `active` `active` TINYINT(4) NOT NULL DEFAULT '1';


ALTER TABLE  `CORE_CLIENT_TYPE` ADD  `label` VARCHAR( 30 ) NOT NULL;
UPDATE  `CORE_CLIENT_TYPE` SET  `label` =  'Collectivity' WHERE  `CORE_CLIENT_TYPE`.`code` =  'COLL';
UPDATE  `CORE_CLIENT_TYPE` SET  `label` =  'Company' WHERE  `CORE_CLIENT_TYPE`.`code` =  'ENTR';
UPDATE  `CORE_CLIENT_TYPE` SET  `label` =  'Individual' WHERE  `CORE_CLIENT_TYPE`.`code` =  'PART';

ALTER TABLE `CORE_COMPANIES` CHANGE `tva_rating` `tva_rating` DECIMAL(8,3) NULL DEFAULT NULL, CHANGE `address1` `address1` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `address2` `address2` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `postal_code` `postal_code` VARCHAR(10) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `city` `city` VARCHAR(60) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `phone1` `phone1` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `phone2` `phone2` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `mobile` `mobile` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `fax` `fax` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `email` `email` VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `site_web` `site_web` VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `tva_number` `tva_number` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `banque` `banque` TEXT CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `iban` `iban` VARCHAR(60) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `rib` `rib` VARCHAR(60) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `rcs` `rcs` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL, CHANGE `symbol_money` `symbol_money` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL;

ALTER TABLE  `CORE_USERS` CHANGE  `tva_number`  `tva_number` VARCHAR( 20 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL ,
CHANGE  `tva_invoice`  `tva_invoice` TINYINT( 4 ) NULL DEFAULT NULL ,
CHANGE  `rib`  `rib` VARCHAR( 60 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL ,
CHANGE  `account_code`  `account_code` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL;



ALTER TABLE  `CORE_CONTACTS` CHANGE  `login`  `login` VARCHAR( 20 ) CHARACTER SET utf8 COLLATE utf8_unicode_ci NULL DEFAULT NULL;
UPDATE CORE_CONTACTS SET login=NULL WHERE login='';

ALTER TABLE  `CORE_CONTACTS` ADD UNIQUE (
`login`
);


CREATE  TABLE IF NOT EXISTS `CORE_CSV_IMPORT` (
  `id` MEDIUMINT NOT NULL AUTO_INCREMENT ,
  `session_id` VARCHAR(80) NULL ,
  `contact_id` MEDIUMINT NOT NULL ,
  `import_date` DATETIME NULL DEFAULT NULL ,
  `import_expire_at` DATETIME NULL DEFAULT NULL ,
  `script_name` VARCHAR(80) NOT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_CORE_CSV_IMPORT_CORE_CONTACTS1` (`contact_id` ASC) ,
  CONSTRAINT `fk_CORE_CSV_IMPORT_CORE_CONTACTS1`
    FOREIGN KEY (`contact_id` )
    REFERENCES `CORE_CONTACTS` (`id` )
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `CORE_CSV_IMPORT_COLUMNS`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `CORE_CSV_IMPORT_COLUMNS` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` VARCHAR(45) NULL DEFAULT NULL ,
  `order` VARCHAR(45) NOT NULL ,
  `csv_import_id` MEDIUMINT NOT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_CORE_CSV_IMPORT_COLUMNS_CORE_CSV_IMPORT1` (`csv_import_id` ASC) ,
  CONSTRAINT `fk_CORE_CSV_IMPORT_COLUMNS_CORE_CSV_IMPORT1`
    FOREIGN KEY (`csv_import_id` )
    REFERENCES `CORE_CSV_IMPORT` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `CORE_CSV_IMPORT_LINES_DATAS`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `CORE_CSV_IMPORT_LINES_DATAS` (
  `id` INT NOT NULL ,
  `line_number` VARCHAR(45) NULL ,
    `col1` TEXT NULL DEFAULT NULL ,
    `col2` TEXT NULL DEFAULT NULL ,
    `col3` TEXT NULL DEFAULT NULL ,
    `col4` TEXT NULL DEFAULT NULL ,
    `col5` TEXT NULL DEFAULT NULL ,
    `col6` TEXT NULL DEFAULT NULL ,
    `col7` TEXT NULL DEFAULT NULL ,
    `col8` TEXT NULL DEFAULT NULL ,
    `col9` TEXT NULL DEFAULT NULL ,
    `col10` TEXT NULL DEFAULT NULL ,
    `col11` TEXT NULL DEFAULT NULL ,
    `col12` TEXT NULL DEFAULT NULL ,
    `col13` TEXT NULL DEFAULT NULL ,
    `col14` TEXT NULL DEFAULT NULL ,
    `col15` TEXT NULL DEFAULT NULL ,
    `col16` TEXT NULL DEFAULT NULL ,
    `col17` TEXT NULL DEFAULT NULL ,
    `col18` TEXT NULL DEFAULT NULL ,
    `col19` TEXT NULL DEFAULT NULL ,
    `col20` TEXT NULL DEFAULT NULL ,
    `col21` TEXT NULL DEFAULT NULL ,
    `col22` TEXT NULL DEFAULT NULL ,
    `col23` TEXT NULL DEFAULT NULL ,
    `col24` TEXT NULL DEFAULT NULL ,
    `col25` TEXT NULL DEFAULT NULL ,
    `col26` TEXT NULL DEFAULT NULL ,
    `col27` TEXT NULL DEFAULT NULL ,
    `col28` TEXT NULL DEFAULT NULL ,
    `col29` TEXT NULL DEFAULT NULL ,
    `col30` TEXT NULL DEFAULT NULL ,
    `col31` TEXT NULL DEFAULT NULL ,
    `col32` TEXT NULL DEFAULT NULL ,
    `col33` TEXT NULL DEFAULT NULL ,
    `col34` TEXT NULL DEFAULT NULL ,
    `col35` TEXT NULL DEFAULT NULL ,
    `col36` TEXT NULL DEFAULT NULL ,
    `col37` TEXT NULL DEFAULT NULL ,
    `col38` TEXT NULL DEFAULT NULL ,
    `col39` TEXT NULL DEFAULT NULL ,
    `col40` TEXT NULL DEFAULT NULL ,
  `csv_import_id` MEDIUMINT NOT NULL ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_CORE_CSV_IMPORT_LINES_DATAS_CORE_CSV_IMPORT1` (`csv_import_id` ASC) ,
  CONSTRAINT `fk_CORE_CSV_IMPORT_LINES_DATAS_CORE_CSV_IMPORT1`
    FOREIGN KEY (`csv_import_id` )
    REFERENCES `CORE_CSV_IMPORT` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

ALTER TABLE  `CORE_CONTACTS` ADD  `hide_quicktour` BOOLEAN NOT NULL;

SELECT @first_company_id := id
FROM CORE_COMPANIES
ORDER BY id ASC LIMIT 1 ;

UPDATE CORE_USERS SET company_id=@first_company_id WHERE user_type="client" AND (company_id=0 OR company_id IS NULL);

UPDATE CORE_CONTACTS SET main_contact=1 WHERE user_id IN(SELECT id FROM CORE_USERS WHERE user_type='employee');